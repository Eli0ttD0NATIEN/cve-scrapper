"use strict";

const cmdParser = require('./CmdParser').CmdParser;
const vulnScrapper = require('./VulnScrapper').VulnScrapper;
const yargs = require('yargs');
const ARGS = yargs.argv;
const exit = yargs.exit;
const CVE_URL =  "https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=";


let main = () => {
    let CmdParserObj = new cmdParser(ARGS);
    let param = CmdParserObj.getParam();
    console.log("========================================");
    console.log("CVE Scrapper v1.0.0:\nby Eli0ttD0NATIEN");
    console.log("========================================");
    console.log("Used Products : " + param['products']);
    console.log("Looking for Vulnerability...");
    console.log("========================================");

    let vulnScrapperObj = new vulnScrapper(CVE_URL, param['products'], param['last']);
    vulnScrapperObj.setVuln().then(() => {
        let vuln = vulnScrapperObj.getVuln();
        CmdParserObj.finalReporting(vuln, vulnScrapperObj.products);
    })
    return 0;
}

main();
